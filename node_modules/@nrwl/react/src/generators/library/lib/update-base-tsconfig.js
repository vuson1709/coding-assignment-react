"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.updateBaseTsConfig = void 0;
const json_1 = require("nx/src/generators/utils/json");
const typescript_1 = require("@nrwl/workspace/src/utilities/typescript");
const devkit_1 = require("@nrwl/devkit");
const maybe_js_1 = require("./maybe-js");
function updateBaseTsConfig(host, options) {
    (0, json_1.updateJson)(host, (0, typescript_1.getRootTsConfigPathInTree)(host), (json) => {
        const c = json.compilerOptions;
        c.paths = c.paths || {};
        delete c.paths[options.name];
        if (c.paths[options.importPath]) {
            throw new Error(`You already have a library using the import path "${options.importPath}". Make sure to specify a unique one.`);
        }
        const { libsDir } = (0, devkit_1.getWorkspaceLayout)(host);
        c.paths[options.importPath] = [
            (0, maybe_js_1.maybeJs)(options, (0, devkit_1.joinPathFragments)(libsDir, `${options.projectDirectory}/src/index.ts`)),
        ];
        return json;
    });
}
exports.updateBaseTsConfig = updateBaseTsConfig;
//# sourceMappingURL=update-base-tsconfig.js.map