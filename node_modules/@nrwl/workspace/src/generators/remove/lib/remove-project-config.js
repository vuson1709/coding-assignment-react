"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.removeProjectConfig = void 0;
const devkit_1 = require("@nrwl/devkit");
/**
 * Deletes the project from the workspace file
 *
 * @param schema The options provided to the schematic
 */
function removeProjectConfig(tree, schema) {
    (0, devkit_1.removeProjectConfiguration)(tree, schema.projectName);
    // Unset default project if deleting the default project
    const nxJson = (0, devkit_1.readNxJson)(tree);
    if (nxJson.defaultProject && nxJson.defaultProject === schema.projectName) {
        const workspacePath = (0, devkit_1.getWorkspacePath)(tree);
        delete nxJson.defaultProject;
        console.warn(`Default project was removed in ${workspacePath} because it was "${schema.projectName}". If you want a default project you should define a new one.`);
        (0, devkit_1.updateNxJson)(tree, nxJson);
    }
    // Remove implicit dependencies onto removed project
    (0, devkit_1.getProjects)(tree).forEach((project, projectName) => {
        if (project.implicitDependencies &&
            project.implicitDependencies.some((projectName) => projectName === schema.projectName)) {
            project.implicitDependencies = project.implicitDependencies.filter((projectName) => projectName !== schema.projectName);
            (0, devkit_1.updateProjectConfiguration)(tree, projectName, project);
        }
    });
}
exports.removeProjectConfig = removeProjectConfig;
//# sourceMappingURL=remove-project-config.js.map